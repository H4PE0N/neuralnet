ROOT_FOLDER := ..

FILES_TARGET := files
CLEAN_TARGET := clean

RUNBLE_FILES = master dataset

COMPILE_FLAGS := -Wall -Werror -g -Og
COMPILE_PRGRM := gcc
COMPILE_LINKS := -lm

DELETE_FLAGS :=
DELETE_COMND := rm

SOURCE_FOLDER := $(ROOT_FOLDER)/source
OBJECT_FOLDER := $(ROOT_FOLDER)/object
BINARY_FOLDER := $(ROOT_FOLDER)/binary

ENGINE_FOLDER := $(SOURCE_FOLDER)/engine
MASTER_FOLDER := $(SOURCE_FOLDER)/master

ENGINE_SOURCE := $(ENGINE_FOLDER)/source
ENGINE_HEADER := $(ENGINE_FOLDER)/header

ENGINE_SOURCES := $(wildcard $(ENGINE_SOURCE)/*.c)
ENGINE_HEADERS := $(wildcard $(ENGINE_HEADER)/*.h)
ENGINE_OBJECTS := $(patsubst $(ENGINE_SOURCE)/%.c, $(OBJECT_FOLDER)/%.o, $(ENGINE_SOURCES))

SOURCE_FILES := $(ENGINE_SOURCES)
HEADER_FILES := $(ENGINE_HEADERS)
OBJECT_FILES := $(ENGINE_OBJECTS)

$(RUNBLE_FILES): %: $(OBJECT_FOLDER)/%.o $(OBJECT_FILES) $(MASTER_FOLDER)/%.c $(SOURCE_FILES) $(HEADER_FILES)
	$(COMPILE_PRGRM) $(OBJECT_FOLDER)/$@.o $(OBJECT_FILES) $(COMPILE_FLAGS) $(COMPILE_LINKS) -o $@

$(OBJECT_FOLDER)/%.o: $(ENGINE_SOURCE)/%.c $(ENGINE_HEADER)/%.h
	$(COMPILE_PRGRM) $< -c $(COMPILE_FLAGS) -o $@

$(OBJECT_FOLDER)/%.o: $(MASTER_FOLDER)/%.c
	$(COMPILE_PRGRM) $< -c $(COMPILE_FLAGS) -o $@

.PRECIOUS: $(OBJECT_FILES) $(RUNBLE_FILES)

DELETE_FILES := $(OBJECT_FOLDER)/*.o $(RUNBLE_FILES)

$(FILES_TARGET):
	$(foreach RUNBLE_FILE, $(RUNBLE_FILES), $(info $(RUNBLE_FILE)))

$(CLEAN_TARGET):
	$(DELETE_COMND) $(DELETE_FLAGS) $(DELETE_FILES)
